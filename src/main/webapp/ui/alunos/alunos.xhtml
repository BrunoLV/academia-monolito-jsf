<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:p="http://primefaces.org/ui" xmlns="http://www.w3.org/1999/xhtml">

<h:body>

    <ui:composition template="/ui/layout/layout.xhtml">

        <ui:define name="content">

            <section class="content-header">
                <h1>
                    Alunos <small>Listagem</small>
                </h1>
                <!--
                <ol class="breadcrumb">
                    <li><a href="#"><i class="fa fa-dashboard"></i> Level</a></li>
                    <li class="active">Here</li>
                </ol>
                -->
            </section>

            <section class="content container-fluid">

                <p:menubar>
                    <p:menuitem value="Novo" outcome="aluno" icon="fa fa-plus"/>
                </p:menubar>

                <p:spacer height="10px"/>

                <div class="box box-default">
                    <div class="box-header with-border">
                        <h:form>

                            <p:messages showDetail="false" showSummary="true" showIcon="true"
                                        closable="true" id="messages"/>

                            <p:remoteCommand name="excluiAluno"
                                             actionListener="#{listaAlunoController.excluiAluno()}"
                                             process="@this" update="dtAlunos messages"/>

                            <div class="box-body">

                                <p:dataTable id="dtAlunos" styleClass="table table-hover"
                                             value="#{listaAlunoController.alunos}" var="aluno" rows="10"
                                             paginator="true"
                                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                             rowsPerPageTemplate="5,10,15"
                                             emptyMessage="Nenhum aluno cadastrado" reflow="true"
                                             resizableColumns="true" liveResize="true">

                                    <p:column style="width: 5%; text-align: center;">
                                        <p:commandLink ajax="false"
                                                       actionListener="#{listaAlunoController.imprimeDetalhesAlunos(aluno.id)}"
                                                       styleClass="btn btn-default"
                                                       process="@this">
                                            <p:fileDownload value="#{listaAlunoController.arquivo}"/>
                                            <i class="fa fa-print"/>
                                        </p:commandLink>
                                    </p:column>

                                    <p:column style="width: 5%; text-align: center;">
                                        <button jsf:action="#{listaAlunoController.edita(aluno)}"
                                                class="btn btn-primary">
                                            <i class="fa fa-pencil"/>
                                        </button>
                                    </p:column>

                                    <p:column style="width: 5%; text-align: center;">
                                        <h:commandLink
                                                actionListener="#{listaAlunoController.preparaExclusao(aluno)}"
                                                styleClass="btn btn-danger">
											<span> <i class="fa fa-trash"/>
											</span>
                                            <f:ajax execute="@this" render="frmDlgExclusao"/>
                                        </h:commandLink>
                                    </p:column>

                                    <p:column>
                                        <h:inputHidden value="#{aluno.id}"/>
                                        <f:facet name="header">
                                            <h:outputText value="Nome"/>
                                        </f:facet>
                                        <h:outputText value="#{aluno.nome}"/>
                                    </p:column>

                                    <p:column style="text-align: center;">
                                        <f:facet name="header">
                                            <h:outputText value="CPF"/>
                                        </f:facet>
                                        <h:outputText value="#{aluno.cpf}"/>
                                    </p:column>

                                    <p:column>
                                        <f:facet name="header">
                                            <h:outputText value="E-Mail"/>
                                        </f:facet>
                                        <h:outputText value="#{aluno.email}"/>
                                    </p:column>

                                    <p:column style="text-align: center;">
                                        <f:facet name="header">
                                            <h:outputText value="Nascimento"/>
                                        </f:facet>
                                        <h:outputText value="#{aluno.dataNascimento}">
                                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                                        </h:outputText>
                                    </p:column>

                                    <p:column style="text-align: center;">
                                        <f:facet name="header">
                                            <h:outputText value="Sexo"/>
                                        </f:facet>
                                        <h:outputText value="#{aluno.sexo.descricao}"/>
                                    </p:column>

                                    <p:column style="text-align: center;">
                                        <f:facet name="header">
                                            <h:outputText value="Situação"/>
                                        </f:facet>
                                        <h:outputText
                                                styleClass="#{listaAlunoController.defineEstiloSituacao(aluno.situacao)}"
                                                value="#{aluno.situacao.descricao}"/>
                                    </p:column>

                                </p:dataTable>

                            </div>
                        </h:form>
                    </div>
                </div>
            </section>

            <div class="modal fade" id="modal-default">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <h:form id="frmDlgExclusao">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"
                                        aria-label="Close">
                                    <span aria-hidden="true">&#160;</span>
                                </button>
                                <h4 class="modal-title">Exclusão de Aluno</h4>
                            </div>
                            <div class="modal-body">
                                <p>
                                    Tem certeza que deseja excluir o aluno <b>
                                    <h:outputText
                                            value="#{listaAlunoController.alunoSelecionado.nome}"/>
                                </b> ?
                                </p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default pull-left"
                                        data-dismiss="modal">Não
                                </button>
                                <button type="button" class="btn btn-primary"
                                        onclick="excluiAluno();">Sim
                                </button>
                            </div>
                        </h:form>
                    </div>
                </div>
            </div>

        </ui:define>
    </ui:composition>

</h:body>


</html>